2.1 SELECT * FROM NHACUNGCAP
2.2 SELECT MAHANG, TENHANG, SOLUONG FROM MATHANG
2.3 SELECT HO, TEN, NGAYLAMVIEC FROM NHANVIEN
2.4 SELECT DIACHI, DIENTHOAI FROM NHACUNGCAP WHERE TENGIAODICH = 'VINAMILK'
2.5 SELECT MAHANG, TENHANG FROM MATHANG WHERE GIAHANG > 100000 AND SOLUONG < 50
2.6 SELECT * FROM MATHANG JOIN NHACUNGCAP ON MAHANG.MACONGTY = NHACUNGCAP.MACONGTY

2.7 SELECT * FROM MATHANG 
    JOIN NHACUNGCAP 
    ON MAHANG.MACONGTY = NHACUNGCAP.MACONGTY 
    WHERE TENCONGTY = 'Việt Tiến'

2.8 SELECT TENCONGTY, DIACHI FROM NHACUNGCAP 
    JOIN MATHANG ON NHACUNGCAP.MACONGTY = MATHANG.MACONGTY
    JOIN LOAIHANG ON MATHANG.MALOAIHANG = LOAIHANG.MALOAIHANG
    WHERE TENLOAIHANG = 'thực phẩm'
    
2.9 SELECT khachhang.TENGIAODICH FROM khachhang 
JOIN dondathang ON khachhang.MAKHACHHANG = dondathang.MAKHACHHANG 
JOIN chitietdathang ON DONDATHANG.SOHOADON = chitietdathang.SOHOADON
 JOIN mathang ON chitietdathang.MAHANG = mathang.MAHANG
  WHERE TENHANG ='hải sản loại 9';

2.10 SELECT TENGIAODICH, NGAYGIAOHANG, NOIGIAOHANG, HO, TEN FROM DONDATHANG 
     JOIN KHACHHANG ON DONDATHANG.MAKHACHHANG = KHACHHANG.MAKHACHHANG 
     JOIN NHANVIEN ON DONDATHANG.MANHANVIEN = NHANVIEN.MANHANVIEN 
     WHERE SOHOADON = 1

2.11  SELECT (LUONGCOBAN + PHUCAP) AS LUONG FROM NHANVIEN 

2.12  SELECT TENHANG, (SOLUONG * GIABAN - SOLUONG * GIABAN * MUCGIAMGIA / 100 ) AS PHAITRA
      FROM DONDATHANG 
      JOIN CHITIETDATHANG ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON 
      JOIN MATHANG ON CHITIETDATHANG.MAHANG = MATHANG.MAHANG 
      WHERE SOHOADON = 3 

2.13 SELECT * FROM KHACHHANG WHERE KHACHHANG.TENGIAODICH = NHACUNGCAP.TENGIAODICH

2.14 SELECT * FROM NHANVIEN v1 
     JOIN NHANVIEN v2 ON v2.NGAYSINH = v1.NGAYSINH 
     WHERE v2.MANHANVIEN != v1.MANHANVIEN

2.15 SELECT * FROM DONDATHANG 
     JOIN KHACHHANG ON KHACHHANG.MAKHACHHANG = DONDATHANG.MAKHACHHANG
     WHERE NOIGIAOHANG = KHACHANG.DIACHI

2.16 SELECT KHACHHANG.TENCONGTY AS TENCONGTY_KH, 
            KHACHHANG.TENGIAODICH AS TENGIAODICH_KH, 
            KHACHHANG.DIACHI AS DIACHI_KH,
	    KHACHHANG.DIENTHOAI AS DIENTHOAI_KH,
 	    NHACUNGCAP.TENCONGTY AS TENCONGTY_NCC, 
            NHACUNGCAP.TENGIAODICH AS TENGIAODICH_NCC, 
            NHACUNGCAP.DIACHI AS DIACHI_NCC,
	    NHACUNGCAP.DIENTHOAI AS DIENTHOAI_NCC,
     FROM KHACHHANG 
     FULLJOIN DONDATHANG ON KHACHHANG.MAKHACHHANG = DONDATHANG.MAKHACHHANG 
     FULLJOIN CHITIETDATHANG ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
     FULLJOIN MATHANG ON CHITIETDATHANG.MAHANG = MATHANG.MAHANG 
     FULLJOIN NHACUNGCAP ON MATHANG.MACONGTY = NHACUNGCAP.MACONGTY

2.17 SELECT * FROM MATHANG LEFT JOIN CHITIETDATHANG 
     ON MATHANG.MAHANG = CHITIETDATHANG.MAHANG 
     WHERE SOHOADON = NULL

2.18 SELECT * FROM NHANVIEN LEFT JOIN DONDATHANG
     ON NHANVIEN.MANHANVIEN = DONDATHANG.MANHANVIEN 
     WHERE SOHOADON = NULL

2.19 SELECT * FROM NHANVIEN WHERE LUONGCOBAN = (SELECT MAX(LUONGCOBAN) FROM NHANVIEN)

2.20 SELECT SUM(SOLUONG * GIABAN - SOLUONG * GIABAN * MUCGIAMGIA / 100) FROM CHITIETDATHANG 
     GROUP BY SOHOADON 

2.21 SELECT MATHANG.* FROM MATHANG 
     JOIN CHITIETDATHANG ON MATHANG.MAHANG = CHITIETDATHANG.MAHANG 
     JOIN DONDATHANG ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON 
     WHERE YEAR(NGAYDATHANG) = 2003
     GROUP BY MATHANG.MAHANG HAVING COUNT(CHITIETDATHANG.MAHANG) = 1
     
2.22 SELECT *, SUM(SOLUONG * GIABAN - SOLUONG * GIABAN * MUCGIAMGIA / 100 ) AS TONGTIEN 
     FROM DONDATHANG JOIN CHITIETDATHANG 
     ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
     GROUP BY MAKHACHHANG 
     
2.23 SELECT COUNT(SOHOADON) AS SOLUONGHOADON 
     FROM NHANVIEN LEFT JOIN DONDATHANG 
     ON NHANVIEN.MANHANVIEN = DONDATHANG.MANHANVIEN
     GROUP BY NHANVIEN.MANHANVIEN

2.24 SELECT SUM(SOLUONG * GIABAN - SOLUONG * GIABAN * MUCGIAMGIA / 100 ) AS TONGTIEN, 
            MONTH(NGAYDATHANG) AS THANG, 
     FROM DONDATHANG JOIN CHITIETDATHANG 
     ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
     WHERE YEAR(NGAYDATHANG) = 2003
     GROUP BY MONTH(NGAYDATHANG)  

2.25 SELECT SUM( (GIABAN - GIABAN*MUCGIAMGIA/100 - GIAHANG)*(CHITIETDATHANG.SOLUONG) ) AS TIENLOI
     FROM CHITIETDATHANG 
     JOIN DONDATHANG ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
     JOIN MATHANG ON MATHANG.MAHANG = CHITIETDATHANG.MAHANG
     WHERE YEAR(NGAYDATHANG) = 2003
     GROUP BY CHITIETDATHANG.MAHANG

2.26 SELECT (MATHANG.SOLUONG + CHITIETDATHANG.SOLUONG) AS TONGSOLUONG,
            MATHANG.TENHANG
     FROM MATHANG LEFT JOIN CHITIETDATHANG 
     ON MATHANG.MAHANG = CHITIETDATHANG.MAHANG

2.27 SELECT NHANVIEN.*, SUM(SOLUONG) AS TONGSOLUONG
     FROM NHANVIEN 
     JOIN DONDATHANG ON NHANVIEN.MANHANVIEN = DONDATHANG.MANHANVIEN
     JOIN CHITIETDATHANG ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
     GROUP BY MANHANVIEN 
     ORDER BY TONGSOLUONG DESC 
     LIMIT 1 
     
2.28  SELECT *, SUM(SOLUONG) AS TONGSOLUONG 
      FROM DONDATHANG JOIN CHITIETDATHANG 
      ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
      GROUP BY SOHOADON 
      ORDER BY TONGSOLUONG ASC 
      LIMIT 1 

2.29  SELECT TOP 1 SUM(SOLUONG * GIABAN - SOLUONG * GIABAN * MUCGIAMGIA / 100)
      FROM DONDATHANG JOIN CHITIETDATHANG 
      ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
      ORDER BY 1 DESC 

2.30  SELECT A.SOHOADON, B.MAHANG, TENHANG, 
             B * SOLUONG * GIABAN * (1 - MUCGIAMGIA/100 )
      FROM (DONDATHANG AS A JOIN CHITIETDATHANG AS B 
      ON A.SOHOADON = B.SOHOADON)
      JOIN MATHANG AS C ON B.MAHANG = C.MAHANG
      ORDER BY A.SOHOADON
      COMPUTE SUM(B * SOLUONG * GIABAN * (1 - MUCGIAMGIA/100 ))
      BY A.SOHOADON 
      
2.31  SELECT MAHANG, MALOAIHANG, TENHANG, TENLOAIHANG, SOLUONG
      FROM MATHANG JOIN LOAIHANG ON MATHANG.MALOAIHANG = LOAIHANG.MALOAIHANG
      ORDER BY LOAIHANG.MALOAIHANG
      COMPUTE SUM(SOLUONG) BY LOAIHANG.MALOAIHANG
      COMPUTE SUM(SOLUONG) 

2.32  SELECT B.MAHANG, TENHANG, 
             SUM( CASE MONTH(NGAYDATHANG) WHEN 1 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG1,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 2 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG2,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 3 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG3,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 4 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG4,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 5 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG5,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 6 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG6,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 7 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG7,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 8 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG8,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 9 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG9,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 10 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG10,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 11 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG11,
             SUM( CASE MONTH(NGAYDATHANG) WHEN 12 THEN B.SOLUONG 
                  ELSE 0 END ) AS THANG12,
             SUM(B.SOLUONG) AS CANAM
        FROM (DONDATHANG AS A JOIN CHITIETDATHANG AS B ON A.SOHOADON = B.SOHOADON)
        JOIN MATHANG AS C ON B.MAHANG = C.MAHANG 
        WHERE YEAR(NGAYDATHANG) = 2003
        GROUP BY B.MAHANG 

2.33 UPDATE DONDATHANG 
     SET NGAYCHUYENHANG = NGAYDATHANG 
     WHERE NGAYCHUYENHANG = NULL

2.34 UPDATE MATHANG 
     SET SOLUONG = SOLUONG * 2
     FROM NHACUNGCAP
     WHERE NHACUNGCAP.MACONGTY = MATHANG.MACONGTY
     AND TENCONGTY = 'VINAMILK'

2.35 UPDATE DONDATHANG 
     SET NOIGIAOHANG = DIACHI 
     FROM KHACHHANG 
     WHERE DONDATHANG.MAKHACHHANG = KHACHHANG.MAKHACHHANG
     AND NOIGIAOHANG = NULL

2.36 UPDATE KHACHHANG
     SET KHACHHANG.DIACHI = NHACUNGCAP.DIACHI
         KHACHHANG.FAX = NHACUNGCAP.FAX 
         KHACHHANG.EMAIL = NHACUNGCAP.EMAIL
         KHACHHANG.DIENTHOAI = NHACUNGCAP.DIENTHOAI
     FROM NHACUNGCAP 
     WHERE KHACHHANG.TENCONGTY = NHACUNGCAP.TENCONGTY
     AND KHACHHANG.TENGIAODICH = NHACCUNGCAP.TENGIAODICH

2.37 UPDATE NHANVIEN
     SET LUONGCOBAN = LUONGCOBAN * 1.5
     FROM DONDATHANG 
     WHERE DONDATHANG.MANHANVIEN = NHANVIEN.MANHANVIEN
     AND YEAR(NGAYDATHANG) = 2003 
     AND MANHANVIEN IN ( SELECT MANHANVIEN FROM DONDATHANG JOIN CHITIETDATHANG
                        ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
                        GROUP BY MANHANVIEN 
                        HAVING SUM(SOLUONG) > 100 )

2.38 UPDATE NHAVIEN 
     SET PHUCAP = LUONGCOBAN * 0.5
     WHERE MANHANVIEN IN ( SELECT MANHANVIEN FROM DONDATHANG JOIN CHITIETDATHANG
                           ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
                           GROUP BY MANHANVIEN 
                           HAVING SUM(SOLUONG) >= ALL( SELECT SUM(SOLUONG)
                                                       FROM DONDATHANG JOIN CHITIETDATHANG
                                                       ON DONDATHANG.SOHOADON = CHITIETDATHANG.SOHOADON
                                                       GROUP BY MANHANVIEN ) 
                          )

2.39 UPDATE NHANVIEN
     SET LUONGCOBAN = LUONGCOBAN * 0.75
     WHERE MANHANVIEN NOT IN  ( SELECT MANHANVIEN FROM DONDATHANG )
                      
2.40 UPDATE DONDATHANG 
     SET SOTIEN = ( SELECT SUM(SOLUONG * GIABAN - SOLUONG * GIABAN * MUCGIAMGIA / 100)
                    FROM CHITIETDATHANG 
                    WHERE SOHOADON = DONDATHANG.SOHOADON
                    GROUP BY SOHOADON )

2.41 DELETE FROM NHANVIEN 
     WHERE DATEDIFF(YEAR, NGAYLAMVIEC, GetDate()) >= 40

2.42 DELETE FROM DONDATHANG
     WHERE YEAR(NGAYDATHANG) < 2000

2.43 DELETE FROM LOAIHANG 
     WHERE MALOAIHANG NOT IN ( SELECT MALOAIHANG FROM MATHANG )


2.44 DELETE FROM KHACHHANG 
     WHERE MAKHACHHANG NOT IN ( SELECT MAKHACHHANG FROM DONDATHANG )

2.45 DELETE FROM MATHANG 
     WHERE SOLUONG = 0 
     AND MAHANG NOT IN ( SELECT MAHANG FROM CHITIETDATHANG )



